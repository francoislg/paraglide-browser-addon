# Paraglide Browser Debug - Monorepo

A Vite plugin that injects debug metadata into ParaglideJS translation strings, making it easy to identify which translation keys are used in your browser.

## ğŸ“¦ Packages

### [`vite-plugin-paraglide-debug`](./packages/vite-plugin-paraglide-debug)

The core Vite plugin that transforms Paraglide-generated message functions to include debug metadata when `VITE_PARAGLIDE_BROWSER_DEBUG=true`.

**Features:**
- ğŸ” Wraps translation strings with `<span data-i18n-key="..." data-i18n-params="...">`
- ğŸš€ Zero runtime overhead in production
- ğŸ”Œ Framework agnostic
- âš¡ Works with Vite HMR

## ğŸ¯ Examples

### [Vanilla JavaScript](./examples/vanilla) âœ…

Simple vanilla JS example demonstrating the plugin with hardcoded messages. Currently running and testable.

**Run it:**
```bash
pnpm dev:vanilla
```

Visit: http://localhost:5175

### SvelteKit (Coming Soon)

Full-featured SvelteKit application with routing and SSR.

### React Router (Coming Soon)

React application using React Router v7 and Paraglide.

## ğŸš€ Quick Start

### Prerequisites

- Node.js 18+
- pnpm (installed globally: `npm install -g pnpm`)

### Installation

```bash
# Clone the repository
git clone <your-repo-url>
cd paraglide-browser-addon

# Install all dependencies
pnpm install

# Run the vanilla example
pnpm dev:vanilla
```

## ğŸ“– How It Works

When `VITE_PARAGLIDE_BROWSER_DEBUG=true` is set:

1. The official Paraglide plugin generates message functions
2. Our debug plugin intercepts and transforms them
3. Translation strings are wrapped with debug metadata
4. In the browser, you can inspect elements to see which keys were used

**Example Transformation:**

```javascript
// Before (generated by Paraglide)
export function welcome() {
  return "Welcome!";
}

// After (transformed by debug plugin)
export function welcome() {
  return __paraglideBrowserDebugWrap("Welcome!", "welcome", {});
}
```

**In the Browser:**

```html
<h1 data-i18n-key="welcome">Welcome!</h1>
```

You can then query elements:
```javascript
document.querySelector('[data-i18n-key="welcome"]')
```

## ğŸ› ï¸ Development

### Monorepo Structure

```
paraglide-browser-addon/
â”œâ”€â”€ packages/
â”‚   â””â”€â”€ vite-plugin-paraglide-debug/    # The plugin package
â”‚       â”œâ”€â”€ src/
â”‚       â”‚   â””â”€â”€ index.js                 # Plugin implementation
â”‚       â”œâ”€â”€ package.json
â”‚       â””â”€â”€ README.md
â”œâ”€â”€ examples/
â”‚   â”œâ”€â”€ vanilla/                         # Vanilla JS example
â”‚   â”œâ”€â”€ sveltekit/                       # (Coming soon)
â”‚   â””â”€â”€ react-router/                    # (Coming soon)
â”œâ”€â”€ pnpm-workspace.yaml                  # Workspace configuration
â”œâ”€â”€ package.json                         # Root package.json
â””â”€â”€ README.md                            # This file
```

### Available Scripts

From the root directory:

```bash
# Run vanilla example
pnpm dev:vanilla

# Build the plugin
pnpm build:plugin

# Run all examples in parallel (when available)
pnpm dev:all

# Install dependencies for all workspaces
pnpm install
```

### Adding a New Example

1. Create a new directory in `examples/`
2. Add a `package.json` with `"vite-plugin-paraglide-debug": "workspace:*"`
3. Configure your `vite.config.js` to use both plugins
4. Add a script to the root `package.json`

## ğŸ› Known Issues

- **Watch Loop:** The Paraglide compiler currently has an issue with watch mode causing repeated recompilations. This doesn't affect functionality but creates noise in the console.
- **Empty Message Files:** In some cases, Paraglide 2.x may not generate individual message files (en.js, es.js, etc.). This is being investigated.

## ğŸ“ Usage in Your Project

Once the plugin is published to npm, you can use it in any Vite project:

```bash
npm install vite-plugin-paraglide-debug
```

```javascript
// vite.config.js
import { defineConfig } from 'vite';
import { paraglideVitePlugin } from '@inlang/paraglide-js';
import { paraglideBrowserDebugPlugin } from 'vite-plugin-paraglide-debug';

export default defineConfig({
  plugins: [
    paraglideVitePlugin({
      project: './project.inlang',
      outdir: './src/paraglide'
    }),
    paraglideBrowserDebugPlugin({
      outdir: './src/paraglide'
    })
  ]
});
```

```bash
# .env
VITE_PARAGLIDE_BROWSER_DEBUG=true
```

## ğŸ¤ Contributing

Contributions are welcome! Please feel free to submit issues and pull requests.

## ğŸ“„ License

MIT

## ğŸ”— Links

- [ParaglideJS Documentation](https://inlang.com/m/gerre34r/library-inlang-paraglideJs)
- [Vite Plugin API](https://vite.dev/guide/api-plugin.html)
- [OpenSpec Documentation](./openspec/AGENTS.md)
